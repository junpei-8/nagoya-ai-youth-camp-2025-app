# NAGOYA TEENS AI CAMP 2025 プログラミングワークショップ

-   [ソースコード (Github)](https://github.com/itnav/nagoya-ai-event-2024-07_b-course)

## プロジェクト概要

このプロジェクトは、AIが3Dマップ内のキャラクターを操作するゲームです。AIは障害物を避けながら、指定されたゴールを目指します。

### 主な機能

-   **3Dマップレンダリング**: Three.js を使用して、3Dマップとキャラクターをリアルタイムに描画します。
-   **AIによる経路探索**: OpenAI API を活用して、AIがマップ内の最適な経路を判断し、キャラクターを自動で操作します。
-   **複数マップ対応**: `map-1` や `map-2` など、複数の異なるマップを読み込んでプレイすることが可能です。各マップには独自の障害物やゴールが設定されています。

## 遊び方

1.  **ゲームの目的**: AIが生成した経路をたどり、キャラクターをスタート地点からゴール地点まで移動させることが目的です。
2.  **ゲームの開始**: 各マップの `index.html` ファイル（例: `map-1/index.html` または `map-2/index.html`）をブラウザで開きます。画面に表示される「スタートボタン」をクリックすると、AIによる経路探索が開始され、キャラクターが自動で移動を開始します。
3.  **ゲーム画面**:
    *   ゲームは3Dマップとして表示され、プレイヤーのキャラクターも3Dで描画されます。
    *   AIが計算した経路に従ってキャラクターがマップ上を移動します。
4.  **操作**:
    *   基本的な操作は「スタートボタン」のクリックのみです。AIが経路探索とキャラクターの移動を自動で行います。

## プロジェクト構造

-   `README.md`: このファイル。プロジェクトの概要、遊び方、プロジェクト構造、設定方法、開発手順を記述しています。
-   `ai-fetch.js`: OpenAI API との通信を処理し、AIからの経路情報を取得します。
-   `ai-system-prompt.js`: AIに対するシステムレベルの指示（プロンプト）を生成します。
-   `game.js`: ゲームの主要なロジックが含まれています。Three.js を用いた3Dシーンのセットアップ、プレイヤーキャラクターの表示と移動、ゲーム全体の初期化処理などを行います。
-   `map-1/`, `map-2/` など: 各マップ専用のファイルが格納されているディレクトリです。
    -   `index.html`: 特定のマップをプレイするためのエントリーポイントとなるHTMLファイルです。ブラウザでこのファイルを開くとゲームが開始されます。
    -   `map.js`: マップの構造（各セルの種類、配置）や外観（色、画像、説明）を定義します。
    -   `style.css`: 各マップページの基本的なスタイルを定義します。
    -   `ai-route-prompt.js`: そのマップにおけるAIの経路探索のための具体的な指示やヒントを記述するファイルです。ユーザーが編集することでAIの経路生成を調整できます。
-   `secret.example.js`: OpenAI APIキーを設定するためのサンプルファイルです。使用する際には、このファイルを `secret.js` にリネームし、自身のAPIキーを設定します。

## 設定

このセクションでは、ゲームのマップ設定とAPIキーの設定方法について説明します。

### 1. マップ設定

各マップ（例: `map-1`、`map-2`）の設定は、それぞれのディレクトリ内にある `map.js` ファイルで行います。

-   **レイアウトの変更**:
    `map.js` 内の `mapConfig.layout` プロパティは、マップの形状を定義する2次元配列です。配列内の文字（例: 's', 'n', 't', 'e'）が各セルに対応します。これを編集することで、壁の配置、通路、スタート地点、ゴール地点などを自由に変更できます。
    ```javascript
    // 例: map-1/map.js の layout プロパティ
    layout: [
        ['s', 'n', 'n', 'n', 'n', 'n'], // 's' がスタート地点
        ['n', 'n', 't', 'n', 'n', 'n'], // 't' が罠
        ['n', 'n', 'o', 'n', 'n', 'n'], // 'o' が障害物
        // ...
        ['o', 'n', 'n', 'n', 'n', 'e'], // 'e' がエンド（ゴール）地点
    ],
    ```

-   **セルプロパティの変更**:
    `mapConfig.cell` プロパティは、`layout` で使用される各文字（セルエイリアス）の詳細設定を定義します。
    -   `type`: セルの種類（例: "start", "end", "trap", "object", "normal"）。これはAIの経路探索に影響を与えます。
    -   `color`: セルの色（16進数カラーコード）。
    -   `image`: セルに表示する画像のパス（オプション）。
    -   `description`: セルの説明（AIに与える情報として利用されます。例: 「このセルは罠です。避けてください。」）。
    ```javascript
    // 例: map-1/map.js の cell プロパティの一部
    cell: {
        s: { type: 'start', image: 'images/start_tile.png', color: '#4444FF' },
        e: { type: 'end', image: 'images/end_tile.png', color: '#FFD700' },
        t: { type: 'trap', image: 'images/trap_tile.png', color: '#FF0000', description: 'このセルは罠です。注意して！' },
        // ... 他のセルの定義
    }
    ```

-   **新しいマップの作成**:
    新しいマップを作成するには、既存のマップディレクトリ（例: `map-1/`）をコピーし、新しい名前（例: `map-3/`）を付けます。その後、新しいディレクトリ内の `map.js` や `ai-route-prompt.js` を編集して、独自のマップとAIの指示を作成します。対応する `index.html` 内のタイトルなども更新してください。

### 2. APIキーの設定

このプロジェクトでは、AIによる経路探索にOpenAI APIを使用します。APIを利用するためには、APIキーの設定が必要です。

1.  プロジェクトのルートディレクトリにある `secret.example.js` ファイルをコピーし、同じ階層に `secret.js` という名前で複製します。(`secret.js` は `.gitignore` によりGitの管理対象外となっています。)
    ```bash
    cp secret.example.js secret.js
    ```
2.  作成した `secret.js` ファイルを開き、`OPENAI_API_KEY` 定数に、ご自身のOpenAI APIキーの値を文字列として設定してください。
    ```javascript
    // secret.js
    export const OPENAI_API_KEY = 'ここにあなたの実際のOpenAI APIキーを貼り付けます';
    ```
    APIキーが正しく設定されていない場合、AI機能は動作しませんのでご注意ください。

## 開発

### 開発サーバーの起動

-   VSCode の Live Server 拡張機能を使用して開発サーバーを起動します。（通常、VSCode の右下のステータスバーにある `Go Live` ボタンをクリックします。）
